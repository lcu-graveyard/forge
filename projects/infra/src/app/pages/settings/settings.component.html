<mat-horizontal-stepper [linear]="true" [selectedIndex]="GetCurrentStepIndex()">
  <mat-step [stepControl]="EntInfraFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="EntInfraFormGroup">
      <ng-template matStepLabel>Enterprise Infrastructure</ng-template>

      <div fxLayout="row wrap" *ngIf="!State.Loading">
        <div fxFlex="25%" fxFlex.lt-md="50%" fxFlex.lt-sm="90%">
          <mat-card class="spread">
            <ng-container>
              <h2 class="mat-headline title" style="text-align: center">Configure Microsoft Azure</h2>

              <img src="assets/img/Azure-logo.png" style="margin-left: 10%; width: 80%" />

              <p class="mat-subtitle paragraph-title spread" style="font-size: 0.8em; text-align:center">
                You can use Azure in numerous ways to work with your devices.
              </p>

              <p class="mat-subtitle paragraph-title"></p>
              Start with Fathym's best practices and templates, which you can customize later.

              <div class="spread">
                <a mat-raised-button color="accent" (click)="GetStartedWithAzure()" style="width: 100%">Get Started</a>
              </div>
            </ng-container>
          </mat-card>
        </div>

        <div fxFlex="25%" fxFlex.lt-md="50%" fxFlex.lt-sm="90%">
          <mat-card class="spread">
            <ng-container>
              <h2 class="mat-headline title" style="text-align: center">Configure with Google</h2>

              <img src="assets/img/google-comingsoon.jpg" style="width: 100%" />

              <!-- <p class="mat-subtitle paragraph-title spread">
                Google...
              </p> -->

              <p class="mat-subtitle paragraph-title">
                Use Google configurations to get your devices running.
              </p>

              <div class="spread">
                <a mat-raised-button color="accent" [disabled]="true" style="width: 100%">Coming Soon!</a>
              </div>
            </ng-container>
          </mat-card>
        </div>

        <div fxFlex="25%" fxFlex.lt-md="50%" fxFlex.lt-sm="90%">
          <mat-card class="spread">
            <ng-container>
              <h2 class="mat-headline title" style="text-align: center">Configure with AWS</h2>

              <img src="assets/img/aws-comingsoon.jpg" style="width: 100%" />

              <!-- <p class="mat-subtitle paragraph-title spread">
                AWS...
              </p> -->

              <p class="mat-subtitle paragraph-title">
                Use Amazon Web Service configurations to get your devices running.
              </p>

              <div class="spread">
                <a mat-raised-button color="accent" [disabled]="true" style="width: 100%">Coming Soon!</a>
              </div>
            </ng-container>
          </mat-card>
        </div>

        <div fxFlex="25%" fxFlex.lt-md="50%" fxFlex.lt-sm="90%">
          <mat-card class="spread">
            <ng-container>
              <h2 class="mat-headline title" style="text-align: center" jjhhbv>Configure with Your Infrastructure</h2>

              <img src="assets/img/infrastructure-comingsoon.jpg" style="width: 100%" />

              <!-- <p class="mat-subtitle paragraph-title spread">
                Something about bringing your own infrastructure...
              </p> -->

              <p class="mat-subtitle paragraph-title">
                Use your company's infrastructure to get your devices running.
              </p>

              <div class="spread">
                <a mat-raised-button color="accent" [disabled]="true" style="width: 100%">Coming Soon!</a>
              </div>
            </ng-container>
          </mat-card>
        </div>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="InfraConfigFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="InfraConfigFormGroup">
      <ng-template matStepLabel>Configure Infrastructure</ng-template>

      <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="State.SetupStep == SetupStepTypes.Azure && !State.Loading">
        <div fxFlex="60%" fxFlex.lt-md="95%">
          <div>
            <mat-card class="spread">
              <div class="spread">
                <p class="mat-body-3 plain-text">
                  Establishing a quality, recurring way to provision and manage architecture is key to delivering quality products. In the
                  following sections we will setup and establish your enterprise source control through GitHub in order to enable a seamless
                  Dev/Ops process for deploying infrastructure and applications. These assets belong to you and your organization, we are
                  here to guide you in setting up and orchestrating the vast array of technolgies needed to deliver quality solutions.
                </p>
              </div>
            </mat-card>

            <ng-container *ngIf="UseDefaultSettings">
              <mat-card class="spread">
                <div class="spread" style="text-align: center">
                  <img src="assets/img/github-logo.png" style="width:75%" />

                  <ng-container *ngIf="!State.GitHub.OAuthConfigured">
                    <h2 class="mat-headline title" style="text-align: center">GitHub Source Control Setup</h2>

                    <p class="mat-body-2">
                      To manage GitHub on your new domain, you'll first have to setup a GitHub OAuth Application. This application will
                      create a secure way for you to mange your enterprise source control across a vast number of users (internal and
                      external).
                    </p>

                    <div class="spread">
                      <a
                        mat-stroked-button
                        color="primary"
                        target="_blank"
                        class="mat-full-width"
                        href="https://github.com/settings/applications/new"
                      >
                        Creating GitHub OAuth App (Start New)
                      </a>
                    </div>

                    <mat-list style="text-align: left;">
                      <mat-list-item>
                        <span matLine>Application Name:</span>

                        <strong matLine>{{ State.EnterpriseName }} - LCU</strong>
                      </mat-list-item>

                      <mat-list-item>
                        <span matLine>Homepage URL:</span>

                        <strong matLine>{{ RootURL }}</strong>
                      </mat-list-item>

                      <mat-list-item>
                        <span matLine>Application Description:</span>

                        <strong matLine>{{ State.EnterpriseName }} - Low Code Unit</strong>
                      </mat-list-item>

                      <mat-list-item>
                        <span matLine>Authorization callback URL:</span>

                        <strong matLine>{{ RootURL }}/.github/authorize</strong>
                      </mat-list-item>
                    </mat-list>

                    <div class="spread">
                      <a
                        mat-stroked-button
                        color="primary"
                        target="_blank"
                        class="mat-full-width"
                        href="https://developer.github.com/apps/building-oauth-apps/creating-an-oauth-app/"
                      >
                        Creating a new GitHub OAuth App (Documentation)
                      </a>
                    </div>

                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="Git Hub Client ID" formControlName="gitHubClientId" required />

                      <!-- <mat-hint>...</mat-hint> -->
                    </mat-form-field>

                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="Git Hub Client Secret" formControlName="gitHubClientSecret" required />

                      <!-- <mat-hint>...</mat-hint> -->
                    </mat-form-field>

                    <div class="spread" *ngIf="!State.SourceControlConfigured">
                      <a mat-raised-button class="mat-full-width" color="primary" (click)="SetupGitHubOAuth()">
                        Configure GitHub Connection
                      </a>
                    </div>
                  </ng-container>

                  <p style="text-align:center; font-style: italic">
                    Fathym strongly recommends you create a new GitHub organization that contains your LCU automation.
                  </p>

                  <mat-form-field class="mat-full-width" *ngIf="State.SourceControlConfigured">
                    <mat-select placeholder="GitHub Organization" (selectionChange)="SetOrg($event)" [value]="State.GitHub.SelectedOrg">
                      <mat-option *ngFor="let org of State.GitHub.Organizations" [value]="org.Login">{{ org.Login }}</mat-option>
                    </mat-select>

                    <!-- <mat-hint>It is recommended that you create a new organization to contain your LCU automation.</mat-hint> -->
                  </mat-form-field>
                </div>
              </mat-card>

              <mat-card class="spread" *ngIf="State.SourceControlConfigured && State.GitHub.SelectedOrg">
                <div class="spread">
                  <h2 class="mat-headline title" style="text-align: center">Microsoft Azure Subscription Setup</h2>

                  <ng-container>
                    <div class="spread">
                      <p class="mat-body-2 plain-text" style="text-align: center">
                        An Azure enterprise and subscription are required.
                      </p>

                      <a
                        mat-stroked-button
                        color="primary"
                        style="margin-top: 1em; margin-bottom: 2em"
                        target="_blank"
                        class="mat-full-width spread"
                        href="https://azure.microsoft.com/free/"
                      >
                        Create a Free Azure Account
                      </a>

                      <p class="mat-body-2 plain-text" style="text-align: center">
                        Fathym needs access to your Azure subscription to help you manage your infrastructure.
                      </p>

                      <a
                        mat-stroked-button
                        color="primary"
                        style="margin-top: 1em; margin-bottom: 2em"
                        target="_blank"
                        class="mat-full-width spread"
                        href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal"
                      >
                        Locate your configuration information
                      </a>
                    </div>

                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="Azure Tenant (Directory) ID" formControlName="azureTenantId" required />

                      <mat-hint>32 Character Limit</mat-hint>
                    </mat-form-field>

                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="Azure Subscription ID" formControlName="azureSubId" required />

                      <mat-hint>32 Character Limit</mat-hint>
                    </mat-form-field>

                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="Azure App ID" formControlName="azureAppId" required />

                      <mat-hint>32 Character Limit</mat-hint>
                    </mat-form-field>

                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="Azure App Auth key" formControlName="azureAppAuthKey" required />

                      <mat-hint>32 Character Limit</mat-hint>
                    </mat-form-field>
                  </ng-container>
                </div>
              </mat-card>
            </ng-container>

            <mat-card class="spread" *ngIf="!UseDefaultSettings">
              <h3 style="text-align:center">Advanced Settings</h3>

              <p style="text-align: center">Coming Soon! Please switch back to Default Azure Settings.</p>
            </mat-card>

            <div class="spread" *ngIf="State.SourceControlConfigured">
              <a mat-raised-button class="mat-full-width" color="accent" (click)="Configure()" [disabled]="!InfraConfigFormGroup.valid"
                >Configure Azure Infrastructure</a
              >

              <a mat-button class="mat-full-width" color="warn" (click)="CancelSetup()" style="margin-top: 2em">Back To Setup</a>
            </div>
          </div>
        </div>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="DevOpsSetupFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="DevOpsSetupFormGroup">
      <ng-template matStepLabel>Setup DevOps</ng-template>

      <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="State.SetupStep == SetupStepTypes.Azure && !State.Loading">
        <div fxFlex="60%" fxFlex.lt-sm="95%">
          <div>
            <mat-card class="spread">
              <div class="spread">
                <p class="mat-body-3 plain-text">
                  A repeatable way to manage the build and release of your solutions is important to the quality of your product. We'll help
                  you setup and establish an end-to-end workflow for the release and deployment of your solutions on your architecture.
                </p>
              </div>
            </mat-card>

            <mat-card class="spread" *ngIf="!State.DevOps.OAuthConfigured">
              <div class="spread" style="text-align: center">
                <img src="assets/img/Azure-logo.png" style="width:25%; margin: auto" />

                <ng-container>
                  <h2 class="mat-headline title" style="text-align: center">Azure DevOps Setup</h2>

                  <ng-container *ngIf="!State.DevOps.Configured">
                    <p class="mat-body-2">
                      To manage DevOps on your new domain, you'll first have to setup an Azure DevOps OAuth Application. This application
                      will create a secure way for you to mange your enterprise DevOps across a vast number of users (internal and
                      external).
                    </p>

                    <div class="spread">
                      <a
                        mat-stroked-button
                        color="primary"
                        target="_blank"
                        class="mat-full-width"
                        href="https://aex.dev.azure.com/app/register?mkt=en-US"
                      >
                        Creating DevOps OAuth App (Start New)
                      </a>
                    </div>

                    <div class="spread" style="text-align: left;">
                      <div class="spread">
                        <mat-list>
                          <mat-list-item>
                            <span matLine>Company name:</span>

                            <strong matLine>{{ State.EnterpriseName }}</strong>
                          </mat-list-item>

                          <mat-list-item>
                            <span matLine>Company website:</span>

                            <strong matLine>{{ RootURL }}</strong>
                          </mat-list-item>

                          <mat-list-item>
                            <span matLine>Terms of service URL:</span>

                            <strong matLine>{{ RootURL }}/terms</strong>
                          </mat-list-item>

                          <mat-list-item>
                            <span matLine>Privacy statement URL:</span>

                            <strong matLine>{{ RootURL }}/privacy</strong>
                          </mat-list-item>
                        </mat-list>
                      </div>

                      <div class="spread">
                        <mat-list>
                          <mat-list-item>
                            <span matLine>Application name:</span>

                            <strong matLine>{{ State.EnterpriseName }} - LCU</strong>
                          </mat-list-item>

                          <mat-list-item>
                            <span matLine>Description:</span>

                            <strong matLine>{{ State.EnterpriseName }} - Low Code Unit</strong>
                          </mat-list-item>

                          <mat-list-item>
                            <span matLine>Logo URL:</span>

                            <strong matLine>{{ RootURL }}/img/logo</strong>
                          </mat-list-item>

                          <mat-list-item>
                            <span matLine>Application website:</span>

                            <strong matLine>{{ RootURL }}</strong>
                          </mat-list-item>

                          <mat-list-item>
                            <span matLine>Authorization callback URL:</span>

                            <strong matLine>{{ RootURL }}/.devops/authorize</strong>
                          </mat-list-item>
                        </mat-list>
                      </div>
                    </div>

                    <div class="spread">
                      <a
                        mat-stroked-button
                        color="primary"
                        target="_blank"
                        class="mat-full-width"
                        href="https://docs.microsoft.com/en-us/azure/devops/integrate/get-started/authentication/oauth?view=azure-devops"
                      >
                        Creating a new DevOps OAuth App (Documentation)
                      </a>
                    </div>

                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="Dev Ops App ID" formControlName="devOpsAppId" required />

                      <!-- <mat-hint>...</mat-hint> -->
                    </mat-form-field>

                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="Dev Ops Client Secret" formControlName="devOpsClientSecret" required />

                      <!-- <mat-hint>...</mat-hint> -->
                    </mat-form-field>

                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="Dev Ops Scopes" formControlName="devOpsScopes" required />

                      <!-- <mat-hint>...</mat-hint> -->
                    </mat-form-field>

                    <div class="spread">
                      <a mat-raised-button class="mat-full-width" color="primary" (click)="SetupDevOpsOAuth()">
                        Configure Azure DevOps Connection
                      </a>
                    </div>
                  </ng-container>
                </ng-container>
              </div>
            </mat-card>

            <mat-card class="spread" *ngIf="State.DevOps.Configured">
              <ng-container>
                <div class="spread">
                  <h2 class="mat-headline title" style="text-align: center">Azure DevOps Setup Details</h2>

                  <mat-list>
                    <mat-list-item>
                      <mat-icon matListIcon>settings_system_daydream</mat-icon>

                      <h3 matLine class="mat-headline">DevOps Project Setup</h3>

                      <p matLine class="mat-body-2" style="word-wrap: break-word !important; white-space: pre-wrap !important">
                          Fathym creates a new Azure DevOps project, LCU OS, that contains your boards, repositories, pipelines, planning, tracking, and more.
                      </p>

                    </mat-list-item>

                    <mat-list-item>
                      <mat-icon matListIcon>build</mat-icon>

                      <h3 matLine class="mat-headline">Build & Release</h3>

                      <p matLine class="mat-body-2" style="word-wrap: break-word !important; white-space: pre-wrap !important">
                        Fathym sets up an automated build and release process using continuous integration (CI) and continuous delivery (CD) for consistent results.
                      </p>
                    </mat-list-item>
                  </mat-list>
                </div>
              </ng-container>
            </mat-card>

            <mat-card class="spread" *ngIf="State.DevOps.Configured">
              <div class="spread">
                <h2 class="mat-headline title" style="text-align: center">Node Package Manager</h2>
                <p style="margin-top: 1em; text-align: center">Create authentication tokens for CLI with NPM. <a href="https://docs.npmjs.com/about-npm/" target="_blank">Learn More</a> about NPM.</p>

                <mat-form-field class="mat-full-width">
                  <input matInput placeholder="NPM Registry URL" formControlName="npmRegistry" required />

                  <!-- <mat-hint>...</mat-hint> -->
                </mat-form-field>

                <mat-form-field class="mat-full-width">
                  <input matInput placeholder="NPM Personal Access Token" formControlName="npmAccessToken" required />

                  <!-- <mat-hint>...</mat-hint> -->
                </mat-form-field>
              </div>
            </mat-card>

            <div class="spread" *ngIf="State.DevOps.Configured">
              <a
                mat-raised-button
                class="mat-full-width"
                color="accent"
                (click)="ConfigureDevOps()"
                [disabled]="!DevOpsSetupFormGroup.valid"
                >Setup Azure DevOps</a
              >
            </div>
          </div>
        </div>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="InfraSetupFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="InfraSetupFormGroup">
      <ng-template matStepLabel>Setup Infrastructure</ng-template>

      <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="State.InfrastructureConfigured && !State.Loading">
        <div fxFlex="60%" fxFlex.lt-sm="95%">
          <mat-card class="spread">
            <ng-container>
              <div class="spread">
                <h2 class="mat-headline title" style="text-align: center">Template Settings</h2>
                <p style="text-align: center">Customize your infrastructure template</p>

                <mat-form-field class="mat-full-width">
                  <mat-select
                    placeholder="Choose a template that best suits your needs"
                    (selectionChange)="SetInfraTemplate($event)"
                    formControlName="infraTemplate"
                    required
                  >
                    <mat-option *ngFor="let opt of State.InfraTemplate.Options" [value]="opt">{{ opt }}</mat-option>
                  </mat-select>

                  <mat-hint>Commit your Habistack Production Infrastructure</mat-hint>
                </mat-form-field>
              </div>
            </ng-container>
          </mat-card>

          <div class="spread" *ngIf="State.SourceControlConfigured">
            <a mat-raised-button class="mat-full-width" color="accent" (click)="CommitInfra()" [disabled]="!InfraSetupFormGroup.valid">
              Commit {{ State.Environment.Name }} Infrastructure
            </a>
          </div>
        </div>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="DataAppSetupFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="DataAppSetupFormGroup">
      <ng-template matStepLabel>Setup Application</ng-template>

      <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="State.DevOps?.Setup && !State.Loading">
        <div fxFlex="60%" fxFlex.lt-sm="95%">
          <mat-card class="spread">
            <div class="spread">
              <h2 class="mat-headline title" style="text-align: center">Nearly Finished!</h2>

              <!-- <p class="mat-body-2 plain-text">Here is where we are at:</p> -->

              <mat-list style="align-content: center">
                <mat-list-item>
                  <mat-icon matListIcon>cloud</mat-icon>

                  <h3 matLine class="mat-headline title title">Enterprise Infrastructure</h3>

                  <p matLine class="mat-body-2 plain-text">
                    Complete!
                  </p>
                </mat-list-item>

                <mat-list-item>
                  <mat-icon matListIcon>build</mat-icon>

                  <h3 matLine class="mat-headline title title">Enterprise DevOps</h3>

                  <p matLine class="mat-body-2 plain-text">
                    Complete!
                  </p>
                </mat-list-item>
              </mat-list>
              <p style="margin-top: 1.5em; text-align: center">Now let's build something beautiful together...</p>
            </div>
          </mat-card>
        </div>

        <div fxFlex="60%" fxFlex.lt-sm="95%">
          <mat-card class="spread">
            <div class="spread">
              <h2 class="mat-headline title" style="text-align: center">Low Code Unit Application Architectures</h2>

              <p matLine class="mat-body-3 plain-text" style="text-align: center">
                Before you start building LCU applications, you need to create and seed a repository.
              </p>
            </div>
          </mat-card>
        </div>

        <div fxFlex="90%" fxFlex.lt-sm="95%">
          <div class="spread">
            <div fxLayout="row wrap" fxLayoutAlign="center start" *ngIf="State.DevOps.Setup && !State.Loading">
              <ng-container *ngIf="!CurrentAppSeed">
                <div fxFlex="30%" fxFlex.lt-sm="95%" *ngFor="let appSeed of State.AppSeed?.Options">
                  <mat-card class="spread">
                    <img mat-card-image [src]="CleanImage(appSeed.ImageSource)" alt="Low Code Unit" />

                    <mat-card-content class="spread">
                      <h3 class="mat-headline title" style="text-align: center; padding: 0px; margin: 0px">{{ appSeed.Name }}</h3>

                      <p matLine class="mat-body-2 plain-text" style="text-align: center">
                        {{ appSeed.Description }}
                      </p>

                      <div class="spread">
                        <a mat-raised-button class="mat-full-width" color="accent" (click)="SetupApplicationSeed(appSeed.Lookup)">
                          Create
                        </a>
                      </div>
                    </mat-card-content>
                  </mat-card>
                </div>
              </ng-container>

              <ng-container *ngIf="CurrentAppSeed">
                <div fxFlex="60%" fxFlex.lt-sm="95%">
                  <mat-card class="spread">
                    <mat-form-field class="mat-full-width">
                      <input matInput placeholder="New {{ CurrentAppSeed.Name }} Name" formControlName="appName" required />

                      <mat-hint>....</mat-hint>
                    </mat-form-field>

                    <div class="spread">
                      <a
                        mat-raised-button
                        class="mat-full-width"
                        color="accent"
                        (click)="CreateAppFromSeed()"
                        [disabled]="!DataAppSetupFormGroup.valid"
                      >
                        Create
                      </a>

                      <a mat-button class="mat-full-width" color="warn" (click)="SetupApplicationSeed(null)">
                        Back to App Seed Select
                      </a>
                    </div>
                  </mat-card>
                </div>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </form>
  </mat-step>
</mat-horizontal-stepper>
