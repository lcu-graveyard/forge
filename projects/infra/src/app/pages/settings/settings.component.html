<!-- <div class="spread">
  <ng-container *ngIf="!State.Loading">
    <ng-container *ngIf="State.InfrastructureConfigured">
    </ng-container>
  </ng-container>

  <mat-spinner *ngIf="State.Loading"></mat-spinner>
</div> -->

<mat-horizontal-stepper [linear]="true" [selectedIndex]="GetCurrentStepIndex()">
  <mat-step [stepControl]="EntInfraFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="EntInfraFormGroup">
      <ng-template matStepLabel>Enterprise Infrastructure</ng-template>

      <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="!State.Loading">
        <div fxFlex="40%">
          <mat-card class="spread">
            <ng-container>
              <h2 class="mat-headline">Use Default Azure Configurations</h2>

              <p class="mat-subtitle spread">
                Azure provides a number of ways to work with Devices...
              </p>

              <p class="mat-subtitle">
                To get started, we'll set you up on a set of best practices, you'll be able to customize in the future.
              </p>

              <div class="spread">
                <a mat-raised-button color="accent" (click)="GetStartedWithAzure()">Get Started on Azure</a>
              </div>
            </ng-container>
          </mat-card>
        </div>

        <div fxFlex="40%">
          <mat-card class="spread">
            <ng-container>
              <h2 class="mat-headline">Use AWS Configurations</h2>

              <p class="mat-subtitle spread">
                AWS...
              </p>

              <p class="mat-subtitle">
                Blah blah blah blah, coming soon, blah blah blah....
              </p>

              <div class="spread">
                <a mat-raised-button color="accent" [disabled]="true">AWS Coming Soon!</a>
              </div>
            </ng-container>
          </mat-card>
        </div>

        <div fxFlex="80%">
          <mat-card class="spread">
            <ng-container>
              <h2 class="mat-headline" jjhhbv>Orchestrate and Expand an Enterprise Infrastructure</h2>

              <p class="mat-subtitle spread">
                Something about bringing your own infrastructure...
              </p>

              <p class="mat-subtitle">
                Blah blah blah blah, coming soon, blah blah blah....
              </p>

              <div class="spread">
                <a mat-raised-button color="accent" [disabled]="true">Customizable Infrastructure Coming Soon!</a>
              </div>
            </ng-container>
          </mat-card>
        </div>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="InfraConfigFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="InfraConfigFormGroup">
      <ng-template matStepLabel>Configure Infrastructure</ng-template>

      <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="State.SetupStep == SetupStepTypes.Azure && !State.Loading">
        <div fxFlex="60%" fxFlex.lt-sm="95%">
          <mat-card class="spread" *ngIf="UseDefaultSettings">
            <ng-container>
              <div class="spread">
                <h4>Git Hub Source Control Setup</h4>

                <div class="spread" *ngIf="!State.SourceControlConfigured">
                  <a mat-raised-button class="mat-full-width" color="primary" [href]="GitHubOAuthURL" target="_parent"
                    >Configure Git Hub Connection</a
                  >
                </div>

                <mat-form-field class="mat-full-width" *ngIf="State.SourceControlConfigured">
                  <mat-select placeholder="GitHub Organization" (selectionChange)="SetOrg($event)" [value]="State.GitHub.SelectedOrg">
                    <mat-option *ngFor="let org of State.GitHub.Organizations" [value]="org.Login">{{ org.Login }}</mat-option>
                  </mat-select>

                  <mat-hint>It is recommended that you create a new organization to contain your LCU automation.</mat-hint>
                </mat-form-field>
              </div>
            </ng-container>
          </mat-card>

          <mat-card class="spread" *ngIf="UseDefaultSettings && State.SourceControlConfigured && State.GitHub.SelectedOrg">
            <ng-container>
              <div class="spread">
                <h4>Azure Subscription Setup</h4>

                <ng-container>
                  <div class="spread">
                    <p class="mat-body-2">
                      You will need your own azure enteprise and subscription to get started, if you don't already have one you can follow
                      these instructions to create one
                    </p>

                    <a
                      mat-stroked-button
                      color="primary"
                      target="_blank"
                      class="mat-full-width spread"
                      href="https://azure.microsoft.com/free/"
                    >
                      Create Free Azure Account
                    </a>

                    <p class="mat-body-2">
                      In order to help you manage your enterprise infrastructure, you'll need to give us access to your subscription.
                    </p>

                    <a
                      mat-stroked-button
                      color="primary"
                      target="_blank"
                      class="mat-full-width spread"
                      href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal"
                    >
                      Follow these directions to find configuration information
                    </a>
                  </div>

                  <mat-form-field class="mat-full-width">
                    <input matInput placeholder="Azure Tenant (Directory) ID" formControlName="azureTenantId" required />

                    <mat-hint>....</mat-hint>
                  </mat-form-field>

                  <mat-form-field class="mat-full-width">
                    <input matInput placeholder="Azure Subscription ID" formControlName="azureSubId" required />

                    <mat-hint>....</mat-hint>
                  </mat-form-field>

                  <mat-form-field class="mat-full-width">
                    <input matInput placeholder="Azure App ID" formControlName="azureAppId" required />

                    <mat-hint>....</mat-hint>
                  </mat-form-field>

                  <mat-form-field class="mat-full-width">
                    <input matInput placeholder="Azure App Auth key" formControlName="azureAppAuthKey" required />

                    <mat-hint>....</mat-hint>
                  </mat-form-field>
                </ng-container>
              </div>
            </ng-container>
          </mat-card>

          <mat-card class="spread" *ngIf="!UseDefaultSettings">
            <h3>Advanced Settings</h3>

            <p>Coming Soon! Please switch back to Default Azure Settings.</p>
          </mat-card>

          <div class="spread" *ngIf="State.SourceControlConfigured">
            <a mat-raised-button class="mat-full-width" color="accent" (click)="Configure()">Configure Azure Infrastructure</a>

            <a mat-button class="mat-full-width" color="warn" (click)="CancelSetup()">Back To Setup</a>
          </div>
        </div>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="DevOpsSetupFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="DevOpsSetupFormGroup">
      <ng-template matStepLabel>Setup Dev Ops</ng-template>

      <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="State.SetupStep == SetupStepTypes.Azure && !State.Loading">
        <div fxFlex="60%" fxFlex.lt-sm="95%">
          <mat-card class="spread" *ngIf="!State.DevOps.Configured">
            <ng-container>
              <div class="spread">
                <h4>Azure Dev Ops Setup</h4>

                <div class="spread">
                  <a mat-raised-button class="mat-full-width" color="primary" [href]="AzureDevOpsOAuthURL" target="_parent">
                    Configure Azure Dev Ops Connection
                  </a>
                </div>
              </div>
            </ng-container>
          </mat-card>

          <mat-card class="spread" *ngIf="State.DevOps.Configured">
            <ng-container>
              <div class="spread">
                <h4>Azure Dev Ops Setup Details</h4>

                <mat-list>
                  <mat-list-item>
                    <mat-icon matListIcon>settings_system_daydream</mat-icon>

                    <h3 matLine class="mat-headline">Dev Ops Project Setup</h3>

                    <p matLine class="mat-body-2">
                      We'll create a new Azure Dev Ops project called 'LCU OS' to contain the various integrations related to your site.
                    </p>
                  </mat-list-item>

                  <mat-list-item>
                    <mat-icon matListIcon>build</mat-icon>

                    <h3 matLine class="mat-headline">Infrastructure Build & Release</h3>

                    <p matLine class="mat-body-2">
                      We'll setup an automatic build and release process that will listen for changes to your infrastructure and deploy them
                      to azure for you. Changes will never delete resources, in order to aintain the integrity of enterprise data.
                    </p>
                  </mat-list-item>
                </mat-list>
              </div>
            </ng-container>
          </mat-card>

          <mat-card>
            <div class="spread">
              <h4>NPM Configuration Details</h4>

              <mat-form-field class="mat-full-width">
                <input matInput placeholder="NPM Registry URL" formControlName="npmRegistry" required />

                <mat-hint>...</mat-hint>
              </mat-form-field>

              <mat-form-field class="mat-full-width">
                <input matInput placeholder="NPM Personal Access Token" formControlName="npmAccessToken" required />

                <mat-hint>...</mat-hint>
              </mat-form-field>
            </div>
          </mat-card>

          <div class="spread" *ngIf="State.DevOps.Configured">
            <a mat-raised-button class="mat-full-width" color="accent" (click)="ConfigureDevOps()" [disabled]="!DevOpsSetupFormGroup.valid"
              >Setup Azure Dev Ops</a
            >
          </div>
        </div>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="InfraSetupFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="InfraSetupFormGroup">
      <ng-template matStepLabel>Setup Infrastructure</ng-template>

      <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="State.InfrastructureConfigured && !State.Loading">
        <div fxFlex="60%" fxFlex.lt-sm="95%">
          <mat-card class="spread">
            <ng-container>
              <div class="spread">
                <h4>Template Settings</h4>

                <mat-form-field class="mat-full-width">
                  <mat-select
                    placeholder="Infrastructure Template"
                    (selectionChange)="SetInfraTemplate($event)"
                    [value]="State.InfraTemplate.SelectedTemplate"
                  >
                    <mat-option *ngFor="let opt of State.InfraTemplate.Options" [value]="opt">{{ opt }}</mat-option>
                  </mat-select>

                  <mat-hint>Select from the available templates.</mat-hint>
                </mat-form-field>
              </div>
            </ng-container>
          </mat-card>

          <div class="spread" *ngIf="State.SourceControlConfigured">
            <a mat-raised-button class="mat-full-width" color="accent" (click)="CommitInfra()" [disabled]="!InfraSetupFormGroup.valid">
              Commit {{ State.Environment.Name }} Infrastructure
            </a>
          </div>
        </div>
      </div>
    </form>
  </mat-step>

  <mat-step [stepControl]="DevOpsSetupFormGroup">
    <mat-spinner *ngIf="State.Loading"></mat-spinner>

    <form [formGroup]="DevOpsSetupFormGroup">
      <ng-template matStepLabel>Setup Application</ng-template>

      <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="State.DevOps?.Setup && !State.Loading">
        <div fxFlex="60%" fxFlex.lt-sm="95%">
          <mat-card class="spread">
            <div class="spread">
              <h4>Phew... Now that that crap is done, let's get to building something.</h4>

              <p class="mat-body-2">Here is where we are at:</p>

              <mat-list>
                <mat-list-item>
                  <mat-icon matListIcon>cloud</mat-icon>

                  <h3 matLine class="mat-headline">Enterprise Infrastructure</h3>

                  <p matLine class="mat-body-2">
                    Yup, we got that...
                  </p>
                </mat-list-item>

                <mat-list-item>
                  <mat-icon matListIcon>build</mat-icon>

                  <h3 matLine class="mat-headline">Enterprise Dev Ops</h3>

                  <p matLine class="mat-body-2">
                    Does a bear shit in the woods?... That means yes, we got that too...
                  </p>
                </mat-list-item>
              </mat-list>
            </div>
          </mat-card>
        </div>

        <div fxFlex="60%" fxFlex.lt-sm="95%">
          <mat-card class="spread">
            <div class="spread">
              <h4 class="mat-display-1">Low Code Unit Application Architectures</h4>

              <p matLine class="mat-body-2 spread">
                Some info on what is next... Let's create and seed a repository so that we can start building our first apps...
              </p>
            </div>
          </mat-card>
        </div>

        <div fxFlex="90%" fxFlex.lt-sm="95%">
          <div class="spread">
            <div fxLayout="row wrap" fxLayoutAlign="center center" *ngIf="State.DevOps.Setup && !State.Loading">
              <ng-container *ngIf="!CurrentAppSeed">
                <div fxFlex="30%" fxFlex.lt-sm="95%" *ngFor="let appSeed of State.AppSeed?.Options">
                  <mat-card class="spread">
                    <img mat-card-image [src]="CleanImage(appSeed.ImageSource)" alt="Low Code Unit" />

                    <mat-card-content class="spread">
                      <h3 class="mat-headline">{{ appSeed.Name }}</h3>

                      <p matLine class="mat-body-2">
                        {{ appSeed.Description }}
                      </p>

                      <div class="spread">
                        <a mat-raised-button class="mat-full-width" color="accent" (click)="SetupApplicationSeed(appSeed.Lookup)">
                          Setup {{ appSeed.Name }}
                        </a>
                      </div>
                    </mat-card-content>
                  </mat-card>
                </div>
              </ng-container>

              <ng-container *ngIf="CurrentAppSeed">
                <div fxFlex="60%" fxFlex.lt-sm="95%">
                  <mat-card class="spread">
                    <form (ngSubmit)="CreateAppFromSeed()">
                      <mat-form-field class="mat-full-width">
                        <input
                          matInput
                          placeholder="New {{ CurrentAppSeed.Name }} Name"
                          [(ngModel)]="State.AppSeed.NewName"
                          name="appName"
                          required
                        />

                        <mat-hint>....</mat-hint>
                      </mat-form-field>

                      <div class="spread">
                        <button mat-raised-button class="mat-full-width" color="accent" type="submit">
                          Create Application
                        </button>

                        <a
                          mat-button
                          class="mat-full-width"
                          color="warn"
                          (click)="SetupApplicationSeed(null)"
                          [disabled]="!DevOpsSetupFormGroup.valid"
                        >
                          Back to App Seed Select
                        </a>
                      </div>
                    </form>
                  </mat-card>
                </div>
              </ng-container>
            </div>
          </div>
        </div>
      </div>
    </form>
  </mat-step>
</mat-horizontal-stepper>
